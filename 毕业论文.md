## 1. 绪论

### 1.1 引言

> 背景介绍  ——>  问题引出  ——> 技术趋势与研究意义 ——> 研究目标与概述

卡巴迪是一项历史悠久的传统体育竞技运动，在20世纪以来，以其运动的趣味性和强对抗性逐渐流行起来。从1990年开始，卡巴迪运动正式入选亚运会体育竞技项目，因为其所需场地条件要求低，便于在大众中展开；同时蕴含在卡巴迪运动当中的灵活、耐力和策略等属性，能够让参与其中的人全面提升各项身心素质水平，近些年来我国在高效、民间等领域大力发展该项运动。

随着人工智能、计算机视觉和电子化设备等领域的大力发展，智慧裁判系统日渐应用在体育领域中的各个运动当中。然而与其他主流体育运动相比，卡巴迪体育项目的智能技术化水平较低，主要是依赖裁判的肉眼识别和相关的人工经验，进行得分与否、犯规与否等情况等判定，对于困难情况的判定存在误判或漏判的情况发生，并且，裁判的判断也极易受到现场压力或选手身份情绪等干扰。

因此，卡巴迪体育项目的裁判系统急需智慧化，需要计算机视觉等技术来辅助裁判进行判罚。对此，基于计算机视觉的学习研究，我将设计一套能够帮助实时进行卡巴迪运动得分、犯规等情况判罚的智慧化系统，将人工经验判罚转化为智能判罚，以避免误判和漏判等情况的发生。同时，该系统所需的设备仅是少数摄像头，十分轻便，有助于高校、民间等卡巴迪运动比赛的举办，节省人力成本的同时又具备高效判定。由此可见，卡巴迪运动体育项目的智慧化裁判系统研究有非常重要的研究和应用意义。



### 1.2 国内外相关技术现状

> 通过 ～～～～ 关键词搜索得到的文献有多少篇，

当今体育运动中运用深度学习技术来辅助裁判判决的技术，大体上可以分为运动员及球追踪、运动行为识别和运动表现评级三大类别。

- 运动员及球追踪（如篮球、足球）的相关技术主要是目标检测的YOLO、Faster R-CNN等模型，用于识别运动员和球的精确位置；
- 运动行为识别是侧重于视频中整个团队成员之间的彼此配合的识别与解析，使用循环神经网络LSTM和目标检测方法相配合；
- 运动表现评级则是通过考虑技术、速度和控制等指标来评估运动给出分数（如跳水、体操运动），主要是通过融合注意力机制和LSTM模型来进行处理。

卡巴迪运动是一项以触碰来实现得分的运动，其核心点在于“触碰”的识别以及触碰得分要发生的前提条件（触碰得分线）。因为运动员之间触碰是微小而迅速的，单单依靠目标检测和人体姿势相关的识别模型不能很好地解决这一难题，我选择精准到像素级识别分割的技术——深度学习下图像的语义分割来完成智慧裁判系统的相关研究。

本课题主要是基于DeepLabv3+模型进行对于卡巴迪比赛中关于场地、运动员等类别的语义分割，作运动员碰撞检测，结合全局的边界信息等，来进行智慧判断得分与否的系统研究。DeepLabV3+模型基于全卷积神经网络结构，并且其还引入了空洞卷积等技术来捕获局部和全局信息，同时采用了监督学习技术进行训练，能够快速、准确地分割出图像中不同类别的物体，适用于需要十分精确分割和小物体识别的场景当中。

为完成相关研究情况的调研，本工作收集的资料范围包括：通过卡巴迪运动、语义分割、deeplab、深度学习图像语义分割、空洞卷积（astrous convolution）、ASPP等关键词搜索得到的相关文献，其中包括卡巴迪运动比赛规则、深度学习图像语义分割方法概述、deeplabv1~v3的基本原理、网络结构以及其演变过程等。在中国知网的搜索结果为：中文文献共70篇，其中包含学术期刊56篇、学位论文14篇；外文文献共111篇。其中对本课题有直接参考价值的文献共14（“我编的”）篇，主要包括深度学习图像语义分割模型、语义分割deeplab的网络架构和语义分割数据集训练的相关标准处理方法。

#### 1.2.1 国外研究现状

> 可以分为，传统图像分割算法
>
> - （阈值分割法、马尔可夫机场模型、边缘检测法、区域法）
>
> 卷积神经网络下的语义分割算法
>
> 先介绍其具体分类，指出深度学习下的图像语义分割要进行的步骤，深度学习下各个不同网络结构（基于区域分类、全监督学习、弱监督学习），接着引入FCN，按顺序发展
>
> - （FCN - 图像分累网络拓展为语义分割网络）
> - （DeepLab - 基于全卷积的扩张语义分割算法）
> - （U-net - 基于全卷积的对称语义分割算法）
> - （基于特征融合的算法）
> - （RNN - 基于循环神经网络的算法）
> - （GAN - 基于生成对抗网络的算法）
> - （基于注意力机制的算法）

1）传统图像分割：

在深度学习卷积神经网络还没有在图像分割领域发挥作用时，一般都是通过数学、统计和信号处理技术等方法来实现对图像的分割。传统图像分割算法主要是通过对图像的底层特征（如形状、颜色、边缘等）来进行像素级别的划分，进而实现图像的区域分割。主要的传统图像语义分割算法有4个：阈值分割法、边缘检测法、区域法、马尔可夫随机场模型。

- 阈值分割法：通过设定不同的阈值来划分图像中不同灰度级别的像素点，进而将不同的像素点分为多个目标区域和背景。关键在于选取合适的阈值，来提高图像中目标的分割精度、增强分割效果。较为常用的阈值划分方法有直方图双峰法、全局阈值法（如Otsu算法 - 最大类间方差法）、p-lite法等。
- 边缘检测法：首先不同区域之间的物体与背景的灰度存在差别，那么边缘就是图像当中灰度出现突然变化的部位，然后将灰度相差最大的点作为边缘点，接着识别出所有边缘点，作一个连接处理，构造出不同目标区域的轮廓，再进行图像分割，分割出多个目标区域和背景。主要是通过图像中像素梯度或二阶导数的变化（如Sobel算法、Laplacian算法等）来检测出对象的边缘点。
- 区域法：将性质特征相似（颜色、灰度等）的像素点选取组合成同一块区域，然后进行图像分割。其基本思想大致上是先确定一个种子像素点，然后根据不同像素点差值与阈值比较，来选择是否进行合并处理，直至没匹配到满足条件的像素点。关键在于初始种子的选择上。
- 马尔可夫随机场模型算法（MRF-Markov Random Field，MRF）：借助马尔可夫随机场模型（MRF）以及贝叶斯理论（Bayes），对经过分类后的图像进行算法统计和学习。通过分析图像当中各个像素点之间的相互关系，确定先验概率，借助像素之间的局部条件依赖关系，以最大后验概率（MAP）优化为目标，将分割问题转化为优化问题来进行处理。

2）基于深度学习的图像语义分割：

传统的图像分割解决的仅仅是多个目标区域与背景的划分，缺乏了在一定程度上图片所要表达的语义信息。Ohta在1980首次提出语义分割，即在图像中的每一个像素分配一个预先定义好的表示其语义类别的标签。在此基础上，与传统的图像分割相比，语义分割更能够根据图像本身的纹理、场景和其他高层语义特征来得出图像本身所表达的信息。近年来，深度学习技术迅速发展，语义分割也在卷积神经网络、循环神经网络等多个网络基础上得到应用和优化。

基于深度学习的图像语义分割目的是对图像中的每个像素进行密集预测并推断其所属的标签，是一个从粗推理到细推理的过程。大体上，分为3个处理模块：特征提取模块、语义分割模块和精细化处理模块，处理流程如下图所示：

<img src="./img/深度学习语义分割流程.png" style="zoom:50%;" />

根据语义分割的方法特点和处理粒度，又分为三个方法：1）基于区域分类的图像语义分割方法，由Carrerira等于2012年首次提出，即利用算法（如SS，selective search）来生成大量候选区域并筛选出合理的候选区域，再利用卷积神经网络CNN对每个候选区域提取图像特征和语义信息，接着利用分类器对候选区域中的图像块或像素块进行分类，最后输出分割结果。在2014年提出区域卷积神经网络RCNN结合SS算法，最后利用SVM（support vector machine）来进行物体分类。

2）全监督学习图像语义分割方法，即采取人工提前标注过的像素作为训练样本，来高效精准地训练网络。Long等人于2014年提出了全卷积神经网络FCN，它能够以全监督学习的方式来进行图像分割，并且兼容任意尺寸的图像大小。其网络结构会由于上采样处理而不能很好地理解图像的细节信息，导致局部特征和全局特征利用率不高的情况发生。Chen和Kokkinos把卷积神经网络与概率图级联形成DeepLab- V1网络，并在FCN的末端增加全连接条件随机场（fully connected conditional random field，FCCRF）来对粗糙分割图进行边界优化，同时使用带孔卷积（astrous convolution）来扩大特征图的感受野。

<img src="./img/Deeplab框架.png" style="zoom:50%;" />

后续Chen等人相继提出将带孔卷积作为上采样滤波器提取特征，结合空间金字塔池化提出ASPP（astrous spatial pyramid pooling）的DeepLab-V2网络；将4个带孔卷积并联成一个一个新的ASPP，再把多个带孔卷积核和新的ASPP串联，组成一个端到端的分割网络，即DeepLab-V3网络，属于全卷积的扩张语义算法。Ronneberger等人于2025年提出了一种对生物医学图像进行语义分割的U-net网络，其基于编码器-解码器结构，利用对称网络结构来进行图像语义解析。编码器部分进行下采样处理，逐渐降低特征图的分辨率，解码器部分进行上采样处理，还原图像细节信息，这属于全卷积的对成语义分割算法。Chen等人同样将编码—解码算法和Xecption网络引入，形成了DeepLab-V3+语义分割网络。还有基于特征融合的算法，通过对各层次、各区域特征的融合来更好地获取图像深层的上下文信息，是用来解决之前算法运算量大，训练时间长的问题。Lin等人提出RefineNet网络，网络中有4种分辨率不同的特征提取模块，在形成特征图后还要与对应的精细模块（残差组件）进行融合，经过多次迭代来得到分割结果。Zhao等人在ResNet网络基础上进行预训练，得到的特征图再同时送入4个并行的池化层来进行池化融合，即PSP（pyramid scene parsing）网络。Pinherio和Collobert利用时间序列，将RNN循环神经网络引入图像语义分割领域。以上是全监督学习图像语义分割的主流算法模型，当中的关键点是FCN全卷积神经网络、空洞卷积、编码-解码结构和融合特征等。

3）弱监督学习图像语义分割方法：前面像素级精确标注图像制作过程费时、费力，难以批量获取。便有学者提出采用经过粗略标记的弱标注图像来进行训练，主要分为以下3类：边界框标签、简笔标签、图像级标签。

<img src="./img/标注.png" style="zoom:50%;" />

- 边界框标签：Dai等人提出BoxSup网络，以全卷积网络为基础，通过边框级标注图像训练分割器。首先借助MGG算法得到初步候选目标区域，然后放到FCN中进行优化更新，结果又送回FCN中进行迭代训练，直到准确率收敛。Rajchl等人利用卷积神经网络重复迭代，提出了DeepCut分割模型。
- 简笔标签：Lin等人创立ScribbleSup网络，分为自动标记过程和图像训练过程，标注后根据简笔画生成像素块，作为图模型的一点，再用GraphCut算法自动完成对所有训练图像的标注，接着便是放入到FCN中训练，得到分割结果。
- 图像级标签：Pinherio等人将MIL（多示例学习）引入，来构建像素语义与图像标签间的关系，通过ImageNet图像级标注训练模型，通过CNN生成特征平面，外加上超像素和MGC等技术，达到了良好的分割效果。

#### 1.2.2 国内研究现状

近几年国内卡巴迪运动才发展起来，还没出现智慧裁判系统的应用。其他体育运动的智慧裁判系统大多都是引入国外，如网球的鹰眼系统（Hawk-eye tennis system）通过摄像头捕捉网球运动轨迹，并借助计算机视觉的增强现实AR手段来实现运动轨迹重演；如足球、篮球中，则是使用视频监控技术（VAR技术）来用于即时回放，辅助裁判进行判别。

至于深度学习的语义分割技术，大多都是利用其对于特定物体的识别分割上。皱凯鑫等人在U-Net网络中的卷积块中提出SN-Disout残差块，并在编码-解码器结构当中引入循环十字交叉模块，进一步增强模型捕获特征的能力，应用于路面缺陷图像的分割上；杨建宇等人发现在农村建设用地上建筑物的识别上，SegNet模型能够很好地提取其光谱信息，并利用其丰富的空间特征来形成较好的分类模型，应用于高分辨遥感影像的农村建设用地分割上；刘文祥等人将双注意力机制与DeepLabv3+融合，将DAMM（Dual Attention Mechanism Module，DAMM）与ASPP层串联或并联，能够融合处理两层特征信息，应用于遥感影像上mIoU更高；体育运动方面，龚威等人则是利用SegNet来分割提取体育视频动作的特征图谱，再借助Softmax分类器来分类当中的图像像素，进而输出体育动作掩膜，得到高分辨率的动作分割结果，用于体育运动训练指导；郑迪昕利用空洞卷积、金字塔池化以及可训练的条件随机场结构对语义分割算法进行改进优化，使用关键节点检测算法来增强细小物体的分割效果，构成SISA算法（Sports Image Segmenation Alogrithm，运动图像分割算法），用于提取视频总运动人物剪影的运动视频分析。







### 1.3 论文主要工作

针对面向“卡巴迪”体育项目的智慧裁判系统研究这一课题，本文拟定了如下研究内容：

（1）首先，了解卡巴迪体育项目相应规则以及其裁判所要进行的判定工作，挖掘出当中能够通过智慧裁判系统来完成的部分，如运动员之间的碰撞检测、越过边界线等。

（2）拟采用DeepLabV3+深度学习语义分割模型来完成智慧裁判系统中最为关键的碰撞检测部分，并且其全局信息的携带便于解决卡巴迪运动得分的先决条件（先跨过得分线，才能进攻得分）。针对DeepLabV3+模型进行原理分析，并使用DeepLabV3+来分割不同运动员，针对分割生成的掩膜来进行碰撞检测。

（3）针对卡巴迪体育项目的运动规则，将DeepLabV3+模型应用到具体的比赛场景，并根据此优化其模型。

（4）基于DeepLabv3+进行可视化展示，同时使用训练好的模型来充当“卡巴迪”体育项目的智慧裁判角色。

为完成以上研究内容：拟采用的研究路线（整体解决思路、技术路线、可行性分析）如下：

（1）整体解决思路：输入比赛视频，通过DeepLabv3+先分割出比赛场地，各个不同含义的边界线等信息，完成全局信息的识别。接着通过目标检测模型快速定位到发生接触到1～3名运动员，再结合DeepLabv3+分割出来的像素级图像，借助其掩膜面积来判定运动员之间触碰与否，并结合全局感知判定得分与否，最终实时给出是否成功得分的判定结果。

（2）技术路线：先获取有关“卡巴迪”体育项目的比赛数据集，并对其数据集进行运动员、场地线等信息的标注。接着选用Goodle官方提供的DeepLabv3+模型来对先前标注好的特定数据集进行训练，同时按照比例划分训练集和测试集，借助其Xception网络或mobileNet网络来对于数据的训练和验证并优化模型，当中的空洞卷积和ASPP模块能够扩大感受野，全局信息更能被纳入考虑。识别后得到分割结果，再根据分割结果的掩膜面积进行关键的触碰判定并结合分割出来的边界线等全局信息来完成智慧裁判的角色人物。

（3）可行性：DeepLabV3+是一种基于全卷积神经网络和全监督学习的扩张性语义分割模型，能够精准像素级地划分图像中的目标类别。DeepLabv3+同时借助编码-解码的结构，在全局信息的保留上具有优异的效用。

### 1.4 论文的组织与结构

本文共计六部分，每部分内容如下：

第一部分：绪论，首先说明研究的背景和意义。其次，根据引用文献，详细阐述国内外相关研究现状。最后，叙述研究内容和成果，并阐述论文组织结构。

第二部分：分析卡巴迪体育项目中具体的规则，相应得分情况的说明解析，以及讲述研究设计的原理基础，包括数据集、空洞卷积、DeepLabV3+网络中的各个结构、MIOU评估标准。

第三部分：首先给出卡巴迪体育项目中成功的触碰得分和失败的触碰得分情况，并对其进行相关说明，其次针对特定数据集进行网络训练，详细介绍图像中目标的分割、掩膜的触碰检测方法，并给出训练以及测试示例验证过程。

第四部分：实验及效果分析，根据特别标注的数据集和验证集来得出本模型的mIoU并对其分析，然后以一场卡巴迪比赛作为测试对象，进行智慧裁判系统的模拟和展示。

第五部分：总结，分析研究的不足之处，并对本次研究进行总结以及对相关研究的展望。



## 2. 关键技术简介

### 2.1 卡巴迪比赛介绍

卡巴迪体育项目，用通俗的说就是一个专业版的“老鹰抓小鸡”的体育运动，发源于印度，是一种团队对抗性运动，同时也是亚运会的体育项目之一。这项运动融合了灵活、耐力和策略，具有趣味性、竞技性、观赏性和创新性等特点，国家近些年来也在高校、民间等领域大力发展该项运动，因为其场地要求简单，有利于在大众中展开，同时又能让参与其中的人全面提高其各项身心素质水平，是积极响应《全民健身国家战略》，《体育强国》建设。

根据《全国卡巴迪运动竞赛规则与裁判法》，标准卡巴迪比赛在室内长方形场地上进行，两队对垒，双方各7名队员，另有替补队员。比赛分上下半场，中场休息5分钟，双方轮流攻守，进攻人员进入对方场地，并在不被抓住的情况下触碰到尽可能多的防守队员而得分，最终得分多者获胜。

<img src="./img/卡巴迪场地图.png" style="zoom:50%;" />

如上图所示，线有底线、得分线、有效进攻线、中线以及两侧的边界线，同时图中还有扩大区。中线将整块场地划分为两个半区，分别对应进攻方和防守方。进攻人员需要跨越中线进入防守方区域来表示进攻的开始，进攻人员想要得分，有两种方式。1）先要跨过有效进攻线（身体的其他任何部位不得接触中线和有效进攻线之间的区域），然后与防守人员进行接触并且在30s内安全地返回到中线（自己方区域），就视为成功得分，同时被触碰到的防守队员会被淘汰出局。在这种情况下，发生进攻人员与防守人员的争斗（接触），图中的扩大区会成为比赛场地的一部分，活动范围更大了。2）防守方有6名及以上防守人员时，得分线即适用，进攻人员此时穿越得分线且不被抓住会得到奖励分1分，如果被抓住，防守方则得1分。

进攻者的困难点不是在于触碰到人，而是在于触碰之后要如何逃离，同理防守者更关注如何抓住触碰到他们的进攻者，而不是一味地躲避触碰，这不仅仅需要身手敏捷， 也需要技巧与策略。在高水平的印度卡巴迪比赛当中，防守方一般是两两组团，一方面是为了减少进攻方在第一时间能够触碰成功脱离进而淘汰掉防守方的人数；另一方面则是分成多个小队，从四周包围进攻人员，并且同时思考“是否能够把进攻人员抓住”的把握有多大，如果把握不大，再上去尝试，如果对方能够安全返回，抓捕过程中被进攻方触碰到的防守人员便会白白地被淘汰。双方在争斗过程同时也要注意到边界线的存在，避免因为出界而被淘汰。

综上所述，卡巴迪是一项灵活兼具策略的体育运动，要求不仅要有体力也要有脑力。触碰、返回、抓捕是卡巴迪双方产生得分的主要动作，也是智慧裁判系统要解决的问题所在。通过DeepLabV3+语义分割模型，像素级地划分视频中发生触碰时的多个视频帧图像，通过双方不同掩膜是否发生重叠来判断有无触碰，同时该模型还划分了多个不同的边界线，保留着对应的全局信息，用来匹配上述所提到的进攻得分方式，来达到一次进攻结束给出相应的得分、淘汰人员等信息。

### 2.2 数据集介绍



### 2.3 DeepLabV3+模型

> - 整体流程图
> - DCNN、Decoder部分的ASPP、Encorder部分的高层特征与底层特征融合
>
> 书写思路：
>
> 1. Deeplabv3+模型是由什么提出，是什么，发展历程，该框架是以什么为基础，完成什么样的工作，其核心思想是什么
>
> 2. 来一张deeplabv3+处理的效果图片，说出图片经过什么处理进而得到这样的效果
>
> 3. deeplabv3+的网络结构，简略地说一下整体的网络流程划分
>
>    - 首先是DCNN中的Xception网络提取特征工作（底层特征、高层特征），三个流（进入流、中间流、出口流）
>    - ASPP模块（处理的目的，如何利用空洞卷积处理），最后又如何进行一个特征融合
>    - Encorder特征融合模块，底层特征与高层特征（要经过4倍双线性插值上采样处理）融合
>    - 最后得出的结果
>
>    有没有相应的公式，当中涉及到的空洞卷积、深度可分离卷积、双线性插值计算

Deeplabv3+模型是由Google Research实验团队在2018年提出，是在原本Deeplab系列模型上进一步解决问题，改进优化的成果。其整体模型是在搭建在全卷积网络FCN（Fully Convolutional Network）上，并融合空洞卷积来扩大感受野、引入编码器-解码器结构和金字塔模型等方法，属于一种扩张语义分割算法，能够有效地分割图像中的物体类别。该模型以TensorFlow和Pytorch为实现基础，官方的版本是基于python语言，同时也能够借助TensorRT等框架将训练好的Deeplabv3+转换为C++可用的格式，来完成高性能的实时推理任务。其核心思想是：借助金字塔模型和编码器-解码器结构来完成对于图像中的物体分割类别的任务，首先通过编码器进行特征提取（高层语义特征和上下文信息），接着借助解码器来恢复细节（高层语义特征与底层空间细节特征相结合），在多个尺度上捕捉信息，最后进行像素分类，输出一张分割出类别的图像。

<img src="./img/DeepLab原理图.png" style="zoom:67%;" />

上图展示了Deeplabv3+完成图像分割任务的基本原理图：首先输入一幅H x W x 3 的RGB图像，示例图像里有一个小猫。分为上下两个部分，上半部分是编码器（Encoder）模块，下半部分是解码器（Decoder）模块。图像首先进入编码器模块，当中的深度卷积神经网络DCNN（Deep Convolutional Neural Network）会分割出图像中的高层语义特征与底层特征，接着高层特征被送入到右侧的空洞空间金字塔池化ASPP（Astrous Spatial Pyramid Pooling）模块，最终并通过1x1卷积调整通道数得到绿色特征块；在解码器模块，底层特征会先与1x1卷积进行通道数调整，接着再与经过4倍上采样的绿色特征块进行特征融合，最后再卷积，再调整图像尺寸大小与输入图像相同，最终输出具有分割效果的预测图，猫体型轮廓为红色，背景被置为黑色的图片。

具体来说：在编码器模块首先图像进入的是DCNN，Deeplabv3+的DCNN默认主干网络是以Aligned Xception网络为基础。该网络的核心在于一个关键假设——“空间相关性和通道相关性可以分开处理，而不需要同时处理。”，在方法上，利用深度可分离卷积（Depthwise Separable Convolution）来代替传统卷积，分两步来处理空间和通道：1）深度卷积（Depthwise Convolution），仅在空间维度上对每个通道独立地进行卷积，提取空间相关性；2）逐点卷积（Pointwise Convolution），使用 1×1 卷积，在通道维度上进行线性组合，提取通道相关性。基于此核心思想，Xception网络将传统卷积的计算量显著降低，同时特征分离更加清晰。尽管如此，在Deeplabv3+中根据语义分割任务的具体要求，还针对性地对其进行了特定的修改来进一步提高特征提取能力以及降低计算复杂度，如下图所示。首先了解Aligned Xception的网络架构，Aligned Xception网络整体结构分为3个部分，1）Entry flow（入口流），提取初步特征，同时将原始图像分辨率逐步降低；2）Middle flow（中间流），包含多个深度可分离卷积模块，保持分辨率不变，提取深层语义特征；3）Exit flow（出口流），进一步压缩特征并提取高层语义信息。

<img src="./img/Xception网络图.png" alt="Xception网络图" style="zoom:67%;" />

图中红色区域就是deeplabv3+在原本Aligned Xception网络基础上进行修改的部分，概括为以下三点：

- 所有最大池化操作都被具有跨步的深度可分离卷积所取代

作用：最大池化是一种降采样操作，目的是为了降低计算复杂度。但是由于最大池化的窗口是固定的，在一定程度上，可能会丢失部分细节信息。使用跨步的深度可分离卷积，通过增大其感受野，更好地保留边缘和局部细节信息，便于语义分割中的像素级预测。

- 在每个 3 × 3 深度卷积之后添加额外的批量归一化（BatchNorm） 和 激活函数ReLU（Rectified Linear Unit） 激活

作用：BatchNorm是为了通过标准化输入特征，避免出现梯度爆炸或消失的情况发生，稳定整体模型的训练；ReLU则是引入非线性，增加非线性能力，使网络能够学习更复杂的映射关系。激活函数为：$f(x)=max(0,x)$ ，因为其对于正值区域的梯度为常数，也能避免梯度消失。

- 网络加深，中间流Middle Flow中，Block由原来的重复8次改为重复16次

作用：通过增加更多Block来有效地扩大感受野，使网络能够更好地捕获长距离依赖关系，进而提取更丰富的特征，增强全局上下文理解能力。

在首先进入的DCNN中，改进后的Aligned Xception 网络利用深度可分离卷积对输入图像进行高层语义特征的提取和底层细节信息的分离操作，将高层特征high-level feature往右送入ASPP模块，底层细节特征low-level feature则送到下方的解码器部分，进行通道数调整后等待ASPP的处理结果。

金字塔池化ASPP模块：从本质上来说，ASPP是将卷积换成空洞卷积（astrous convolution）的SPP（Spatial Pyramid Pooling），而SPP的提出则是解决CNN输入图像大小必须固定的问题（VGG16网络模型当中的全连接层要求输入数据固定大小），来实现输入图像高宽比和大小任意。其主要手段是通过将卷积得到的特征映射分别分为$16\times256，4\times256$和$1\times256$（256是通道数，channel），将特征映射转化成$16\times256+4\times256+1\times256=21\times256$的矩阵，在送入全连接层时扩展成一维的矩阵$1\times10752$来解决固定大小的问题。在DeeplabV1阶段便引入了空洞卷积，加入一个膨胀率（Dilation Rate，r）的参数定义卷积核的扩展方式，来使得卷积核的感受野变大。当$r=1$时，空洞卷积即标准卷积，若其感受野是$K \times K$，那么当$r>1$时，卷积核的元素之间就会插入$r-1$个元素，整体感受野会变成$(K+(K−1)(r−1))\times(K+(K−1)(r−1))$。如下图所示，从左到右分别是标准卷积、膨胀率为6的空洞卷积、膨胀率为24的空洞卷积，对应的感受野分别是$3\times3,13\times13,47\times47$，膨胀率越大，其感受野越大。

<img src="img/空洞卷积图.png" alt="空洞卷积图" style="zoom: 50%;" />

<img src="img/ASPP图.png" alt="./image/ASPP图.png" style="zoom:67%;" />

由上图可以观察出，ASPP由$1\times1$的卷积、$3\times3$膨胀率为6的空洞卷积、$3\times3$膨胀率为12的空洞卷积、$3\times3$膨胀率为18的空洞卷积以及Image Pooling（全局平均池化）所组成，里面的每个模块都能提取出相应的特征块（根据膨胀率大小的不同，提取的特征图分别聚焦于细粒度的局部信息、中等范围的上下文信息、大范围的上下文和全局信息），对图片大小进行调整后，会进行堆叠合并操作（目的是融合各种维度的特征信息），最终通过$1\times1$的卷积+BatchNorm+ReLU对堆叠特征的通道数进行调整，得到绿色特征块。得到的绿色特征块，融合了所有分支的信息，既能捕获细节，又具备全局视野，具备适合解码器处理的上下文特征。

<img src="img/解码器模块.png" alt="./img/解码器模块.png" style="zoom:50%;" />

解码器模块：如上图所示，经过DCNN得到的底层特征low-level feature（特征分辨率高，语义信息弱，主要保留边缘和细节信息）首先通过$1\times1$卷积对其进行通道数压缩（降低分辨率），调整为Num_Classes，得到粉色特征块；DCNN分解出的另一高层特征high-level feature（分辨率低，语义信息丰富）经过ASPP模块处理后得到的绿色特征块，进行一次4倍的双线性插值上采样操作来提高分辨率与粉色特征块相同；然后将上采样后的高层特征与底层特征按通道维度连接，特征融合；接着对融合后的特征应用$3\times3$卷积操作，并附带BatchNorm和ReLU激活，来提取融合后的深层次信息，生成语义一致且细节清晰的特征图；最终又通过4倍上采样来resize图片大小，使得最终输出层，宽高和输入图片一样，输出带有物体类别划分的效果图。

### 2.4 模型评估标准



### 2.5 本章小结



## 3. 卡巴迪触碰动作检测的设计与实现

### 3.1 数据集处理



### 3.2 网络构建



### 3.3 模型部署



### 3.4 实现流程



### 3.5 本章小结

